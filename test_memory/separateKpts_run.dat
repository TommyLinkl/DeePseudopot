############################################
Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

############################################
Reading and setting up the BulkSystems. 
There are 3 atomic pseudopotentials. They are in the order of: 
['Cs' 'I' 'Pb']
Cs is being initialized to the function form as stored in /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/separateKpts_inputs/init_CsParams.par
I is being initialized to the function form as stored in /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/separateKpts_inputs/init_IParams.par
Pb is being initialized to the function form as stored in /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/separateKpts_inputs/init_PbParams.par
Memory Usage: 0.23 GB
Initializing the ham class for each BulkSystem. 
Finished initializing 0-th Hamiltonian Class... Elapsed time: 0.01 seconds
Memory Usage: 0.23 GB

############################################
Initializing the NN with file /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/separateKpts_inputs/init_PPmodel.pth.

Done with NN initialization to the file /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/separateKpts_inputs/init_PPmodel.pth.
Memory Usage: 0.23 GB

############################################
Start training of the NN to fit to band structures. 
Memory Usage: 0.24 GB
Memory Usage: 0.24 GB
Memory Usage: 0.24 GB
Memory Usage: 2.26 GB
Memory Usage: 2.26 GB
Memory Usage: 2.47 GB
Memory Usage: 2.47 GB
Memory Usage: 0.90 GB
Memory Usage: 2.72 GB
Memory Usage: 2.72 GB
Memory Usage: 2.83 GB
Memory Usage: 2.83 GB
Memory Usage: 1.25 GB
Memory Usage: 2.83 GB
Memory Usage: 2.83 GB
Memory Usage: 2.88 GB
Memory Usage: 2.88 GB
Memory Usage: 1.30 GB
Memory Usage: 1.30 GB
Epoch [1/3], training cost: 19.2939
Memory Usage: 1.30 GB
Memory Usage: 1.30 GB
Memory Usage: 1.30 GB
Memory Usage: 1.30 GB
Memory Usage: 1.31 GB
Memory Usage: 1.31 GB
Memory Usage: 1.30 GB
Memory Usage: 1.30 GB
Memory Usage: 1.31 GB
Memory Usage: 1.31 GB
Memory Usage: 1.31 GB
Memory Usage: 1.31 GB
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Epoch [1/3], validation cost: 196.1243
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Memory Usage: 2.89 GB
Memory Usage: 2.89 GB
Memory Usage: 2.91 GB
Memory Usage: 2.91 GB
Memory Usage: 1.33 GB
Memory Usage: 2.91 GB
Memory Usage: 2.91 GB
Memory Usage: 2.94 GB
Memory Usage: 2.94 GB
Memory Usage: 1.35 GB
Memory Usage: 2.93 GB
Memory Usage: 2.93 GB
Memory Usage: 2.95 GB
Memory Usage: 2.95 GB
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Epoch [2/3], training cost: 196.1243
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Memory Usage: 1.32 GB
Memory Usage: 1.34 GB
Memory Usage: 1.34 GB
Memory Usage: 1.33 GB
Memory Usage: 1.33 GB
Memory Usage: 1.34 GB
Memory Usage: 1.34 GB
Memory Usage: 1.33 GB
Memory Usage: 1.33 GB
Memory Usage: 1.34 GB
Memory Usage: 1.34 GB
Epoch [2/3], validation cost: 31.3780
Memory Usage: 1.34 GB
Memory Usage: 1.34 GB
Memory Usage: 1.34 GB
Memory Usage: 1.34 GB
Memory Usage: 2.91 GB
Memory Usage: 2.91 GB
Memory Usage: 2.92 GB
Memory Usage: 2.92 GB
Memory Usage: 1.34 GB
Memory Usage: 2.93 GB
Memory Usage: 2.93 GB
Memory Usage: 2.97 GB
Memory Usage: 2.97 GB
Memory Usage: 1.39 GB
Memory Usage: 2.97 GB
Memory Usage: 2.97 GB
Memory Usage: 2.98 GB
Memory Usage: 2.98 GB
Memory Usage: 1.40 GB
Memory Usage: 1.40 GB
Epoch [3/3], training cost: 31.3780
Memory Usage: 1.40 GB
Memory Usage: 1.40 GB
Memory Usage: 1.39 GB
Memory Usage: 1.39 GB
Memory Usage: 1.41 GB
Memory Usage: 1.41 GB
Memory Usage: 1.40 GB
Memory Usage: 1.40 GB
Memory Usage: 1.41 GB
Memory Usage: 1.41 GB
Memory Usage: 1.40 GB
Memory Usage: 1.40 GB
Memory Usage: 1.41 GB
Memory Usage: 1.41 GB
Epoch [3/3], validation cost: 66.4601
Memory Usage: 1.41 GB
GPU training: elapsed time: 83.45 seconds
