############################################
WARNING: Using checkpointing! Please use this as a last resort, only for pseudopotential fitting where memory limit is a major issue. The code will run slower due to checkpointing. 
############################################

############################################
Reading and setting up the BulkSystems. 
There are 3 atomic pseudopotentials. They are in the order of: 
['Cs' 'I' 'Pb']
Cs is being initialized to the function form as stored in /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/checkpoint_inputs/init_CsParams.par
I is being initialized to the function form as stored in /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/checkpoint_inputs/init_IParams.par
Pb is being initialized to the function form as stored in /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/checkpoint_inputs/init_PbParams.par
Memory Usage: 0.23 GB
Initializing the ham class for each BulkSystem. 
Finished initializing 0-th Hamiltonian Class... Elapsed time: 0.01 seconds
Memory Usage: 0.23 GB

############################################
Initializing the NN with file /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/checkpoint_inputs/init_PPmodel.pth.

Done with NN initialization to the file /global/u2/t/tommylin/NN_pseudopotential_fitting/test_memory/checkpoint_inputs/init_PPmodel.pth.
Memory Usage: 0.23 GB

############################################
Start training of the NN to fit to band structures. 
Memory Usage: 0.24 GB
Memory Usage: 0.24 GB
Memory Usage: 0.24 GB
Memory Usage: 0.63 GB
Memory Usage: 0.63 GB
Memory Usage: 0.86 GB
Memory Usage: 0.86 GB
Memory Usage: 1.21 GB
Memory Usage: 1.21 GB
Memory Usage: 1.33 GB
Memory Usage: 1.33 GB
Memory Usage: 1.58 GB
Memory Usage: 1.58 GB
Memory Usage: 1.67 GB
Memory Usage: 1.67 GB
Memory Usage: 1.67 GB
Memory Usage: 1.67 GB
Memory Usage: 1.67 GB
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Epoch [1/3], training cost: 19.2939
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.69 GB
Memory Usage: 1.69 GB
Memory Usage: 1.70 GB
Memory Usage: 1.70 GB
Memory Usage: 1.72 GB
Memory Usage: 1.72 GB
Memory Usage: 1.73 GB
Memory Usage: 1.73 GB
Memory Usage: 1.74 GB
Memory Usage: 1.74 GB
Epoch [1/3], validation cost: 196.1243
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.68 GB
Memory Usage: 1.67 GB
Memory Usage: 1.67 GB
Memory Usage: 1.70 GB
Memory Usage: 1.70 GB
Memory Usage: 1.70 GB
Memory Usage: 1.70 GB
Memory Usage: 1.72 GB
Memory Usage: 1.72 GB
Memory Usage: 1.72 GB
Memory Usage: 1.72 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Epoch [2/3], training cost: 196.1243
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Epoch [2/3], validation cost: 31.3780
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Memory Usage: 1.78 GB
Memory Usage: 1.78 GB
Memory Usage: 1.80 GB
Memory Usage: 1.80 GB
Memory Usage: 1.79 GB
Memory Usage: 1.79 GB
Memory Usage: 1.81 GB
Memory Usage: 1.81 GB
Memory Usage: 1.80 GB
Memory Usage: 1.80 GB
Memory Usage: 1.82 GB
Memory Usage: 1.82 GB
Memory Usage: 1.82 GB
Memory Usage: 1.82 GB
Memory Usage: 1.82 GB
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Epoch [3/3], training cost: 31.3780
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Memory Usage: 1.84 GB
Memory Usage: 1.84 GB
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Memory Usage: 1.84 GB
Memory Usage: 1.84 GB
Memory Usage: 1.83 GB
Memory Usage: 1.83 GB
Memory Usage: 1.84 GB
Memory Usage: 1.84 GB
Epoch [3/3], validation cost: 66.4601
Memory Usage: 1.84 GB
GPU training: elapsed time: 95.87 seconds
