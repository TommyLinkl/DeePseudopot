############################################
# Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

Setting OMP_NUM_THREADS = 1, MKL_NUM_THREADS = 1
########################################
Reading and setting up the BulkSystems.
There are 3 atomic pseudopotentials. They are in the order of: ['Cs' 'I' 'Pb']

Initializing the ham class for each BulkSystem. 
initializing SO: kpt 1/3
initializing SO: kpt 2/3
initializing SO: kpt 3/3
initializing NL pots: kpt 1/3
time int1: 0.5449988842010498
int2 est. maxerr: 5.371303441514642e-06
time int2: 0.9336700439453125
initializing NL pots: kpt 2/3
time int1: 0.5633161067962646
int2 est. maxerr: 5.2374464733077656e-06
time int2: 0.9256329536437988
initializing NL pots: kpt 3/3
time int1: 0.5481040477752686
int2 est. maxerr: 4.763142111963104e-06
time int2: 0.9445879459381104
Finished putting the cached SO and NLmats into shared memory ...
Elapsed time: 12.03 seconds

Total num_cores available = 12. We are using num_cores = 3.
Old Zunger BS: Finished calculating 0-th band structure in the Zunger function form ... Elapsed time: 10.68 seconds
The total bandStruct MSE = 1.953640e-01 

########################################
Initializing the NN with file test_parallel/inputs_SOC_para3/init_PPmodel.pth.
Done with NN initialization to the file test_parallel/inputs_SOC_para3/init_PPmodel.pth.
Plotting and write pseudopotentials in the real and reciprocal space.

Evaluating band structures using the initialized pseudopotentials. 
Total num_cores available = 12. We are using num_cores = 3.
Finished calculating 0-th band structure in the initialized NN form... Elapsed time: 16.23 seconds
The total bandStruct MSE = 7.788942e+01 

########################################
Start training of the NN to fit to band structures. 
Total num_cores available = 12. We are using num_cores = 3.
Epoch [1/1], training cost: 209.6409
Total num_cores available = 12. We are using num_cores = 3.
Epoch [1/1], validation cost: 32.3732
Training elapsed time: 55.41 seconds

########################################
Writing the NN pseudopotentials
