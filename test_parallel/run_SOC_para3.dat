############################################
# Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

Setting OMP_NUM_THREADS = 3, MKL_NUM_THREADS = 1
########################################
Reading and setting up the BulkSystems.
There are 3 atomic pseudopotentials. They are in the order of: ['Cs' 'I' 'Pb']

Initializing the ham class for each BulkSystem. 
initializing SO: kpt 1/3
initializing SO: kpt 2/3
initializing SO: kpt 3/3
initializing NL pots: kpt 1/3
time int1: 1.2026171684265137
int2 est. maxerr: 2.0416060129877493e-05
time int2: 1.2905840873718262
initializing NL pots: kpt 2/3
time int1: 1.5979259014129639
int2 est. maxerr: 2.2291572682285044e-05
time int2: 1.2972557544708252
initializing NL pots: kpt 3/3
time int1: 1.1883959770202637
int2 est. maxerr: 2.0926245816032496e-05
time int2: 1.0760977268218994
Finished putting the cached SO and NLmats into shared memory ...
Elapsed time: 26.35 seconds

Total num_cores available = 256. We are using num_cores = 3.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 0.81 seconds
Building SOmat, elapsed time: 0.86 seconds
Building NLmat, elapsed time: 1.31 seconds
Building Htot, elapsed time: 3.33 seconds
eigvalsh and storing energies, elapsed time: 4.33 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 0.85 seconds
Building SOmat, elapsed time: 0.79 seconds
Building NLmat, elapsed time: 1.24 seconds
Building Htot, elapsed time: 3.27 seconds
eigvalsh and storing energies, elapsed time: 4.36 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 0.85 seconds
Building SOmat, elapsed time: 0.80 seconds
Building NLmat, elapsed time: 1.34 seconds
Building Htot, elapsed time: 3.38 seconds
eigvalsh and storing energies, elapsed time: 4.25 seconds
Old Zunger BS: Finished calculating 0-th band structure in the Zunger function form ... Elapsed time: 8.03 seconds
The total bandStruct MSE = 1.953641e-01 

########################################
Initializing the NN with file test_parallel/inputs_SOC_para3/init_PPmodel.pth.
Done with NN initialization to the file test_parallel/inputs_SOC_para3/init_PPmodel.pth.
Plotting and write pseudopotentials in the real and reciprocal space.

Evaluating band structures using the initialized pseudopotentials. 
Total num_cores available = 256. We are using num_cores = 3.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.27 seconds
Building SOmat, elapsed time: 0.60 seconds
Building NLmat, elapsed time: 1.32 seconds
Building Htot, elapsed time: 5.62 seconds
eigvalsh and storing energies, elapsed time: 5.33 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.06 seconds
Building SOmat, elapsed time: 0.61 seconds
Building NLmat, elapsed time: 1.37 seconds
Building Htot, elapsed time: 5.67 seconds
eigvalsh and storing energies, elapsed time: 5.45 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.43 seconds
Building SOmat, elapsed time: 0.71 seconds
Building NLmat, elapsed time: 1.32 seconds
Building Htot, elapsed time: 5.96 seconds
eigvalsh and storing energies, elapsed time: 5.24 seconds
Finished calculating 0-th band structure in the initialized NN form... Elapsed time: 11.77 seconds
The total bandStruct MSE = 7.788923e+01 

########################################
Start training of the NN to fit to band structures. 
Total num_cores available = 256. We are using num_cores = 3.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 5.81 seconds
Building SOmat, elapsed time: 1.14 seconds
Building NLmat, elapsed time: 2.20 seconds
Building Htot, elapsed time: 9.67 seconds
eigvalsh and storing energies, elapsed time: 11.81 seconds
loss_backward + optimizer.step, elapsed time: 12.33 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 6.15 seconds
Building SOmat, elapsed time: 1.02 seconds
Building NLmat, elapsed time: 2.29 seconds
Building Htot, elapsed time: 9.99 seconds
eigvalsh and storing energies, elapsed time: 12.64 seconds
loss_backward + optimizer.step, elapsed time: 11.49 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 5.69 seconds
Building SOmat, elapsed time: 0.97 seconds
Building NLmat, elapsed time: 2.39 seconds
Building Htot, elapsed time: 9.50 seconds
eigvalsh and storing energies, elapsed time: 11.97 seconds
loss_backward + optimizer.step, elapsed time: 12.68 seconds
Epoch [1/1], training cost: 209.6415
Total num_cores available = 256. We are using num_cores = 3.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.27 seconds
Building SOmat, elapsed time: 0.34 seconds
Building NLmat, elapsed time: 1.28 seconds
Building Htot, elapsed time: 5.12 seconds
eigvalsh and storing energies, elapsed time: 3.94 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.07 seconds
Building SOmat, elapsed time: 0.37 seconds
Building NLmat, elapsed time: 1.22 seconds
Building Htot, elapsed time: 4.86 seconds
eigvalsh and storing energies, elapsed time: 4.43 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.35 seconds
Building SOmat, elapsed time: 0.35 seconds
Building NLmat, elapsed time: 1.16 seconds
Building Htot, elapsed time: 5.18 seconds
eigvalsh and storing energies, elapsed time: 4.16 seconds
Epoch [1/1], validation cost: 32.3732
Training elapsed time: 46.96 seconds

########################################
Writing the NN pseudopotentials
