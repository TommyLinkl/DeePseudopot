############################################
# Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

Setting OMP_NUM_THREADS = 1, MKL_NUM_THREADS = 1
########################################
Reading and setting up the BulkSystems.
There are 3 atomic pseudopotentials. They are in the order of: ['Cs' 'I' 'Pb']

Initializing the ham class for each BulkSystem. 
initializing SO: kpt 1/3
initializing SO: kpt 2/3
initializing SO: kpt 3/3
initializing NL pots: kpt 1/3
time int1: 0.5461742877960205
int2 est. maxerr: 5.371303441514642e-06
time int2: 0.9226617813110352
initializing NL pots: kpt 2/3
time int1: 0.5547678470611572
int2 est. maxerr: 5.2374464733077656e-06
time int2: 0.9397151470184326
initializing NL pots: kpt 3/3
time int1: 0.5507619380950928
int2 est. maxerr: 4.763142111963104e-06
time int2: 0.9361581802368164
Elapsed time: 8.93 seconds

Building VlocMat, elapsed time: 0.37 seconds
Building SOmat, elapsed time: 0.28 seconds
Building NLmat, elapsed time: 0.49 seconds
Building Htot, elapsed time: 1.17 seconds
eigvalsh and storing energies, elapsed time: 5.10 seconds
Building VlocMat, elapsed time: 0.39 seconds
Building SOmat, elapsed time: 0.18 seconds
Building NLmat, elapsed time: 0.46 seconds
Building Htot, elapsed time: 1.06 seconds
eigvalsh and storing energies, elapsed time: 4.95 seconds
Building VlocMat, elapsed time: 0.35 seconds
Building SOmat, elapsed time: 0.20 seconds
Building NLmat, elapsed time: 0.57 seconds
Building Htot, elapsed time: 1.15 seconds
eigvalsh and storing energies, elapsed time: 4.87 seconds
Old Zunger BS: Finished calculating 0-th band structure in the Zunger function form ... Elapsed time: 18.31 seconds
The total bandStruct MSE = 1.953645e-01 

########################################
Initializing the NN with file test_parallel/inputs_SOC_noPara/init_PPmodel.pth.
Done with NN initialization to the file test_parallel/inputs_SOC_noPara/init_PPmodel.pth.
Plotting and write pseudopotentials in the real and reciprocal space.

Evaluating band structures using the initialized pseudopotentials. 
Building VlocMat, elapsed time: 2.60 seconds
Building SOmat, elapsed time: 0.29 seconds
Building NLmat, elapsed time: 0.63 seconds
Building Htot, elapsed time: 3.61 seconds
eigvalsh and storing energies, elapsed time: 4.80 seconds
Building VlocMat, elapsed time: 2.12 seconds
Building SOmat, elapsed time: 0.33 seconds
Building NLmat, elapsed time: 0.62 seconds
Building Htot, elapsed time: 3.18 seconds
eigvalsh and storing energies, elapsed time: 4.87 seconds
Building VlocMat, elapsed time: 1.97 seconds
Building SOmat, elapsed time: 0.32 seconds
Building NLmat, elapsed time: 0.63 seconds
Building Htot, elapsed time: 3.00 seconds
eigvalsh and storing energies, elapsed time: 4.66 seconds
Finished calculating 0-th band structure in the initialized NN form... Elapsed time: 24.12 seconds
The total bandStruct MSE = 7.788942e+01 

########################################
Start training of the NN to fit to band structures. 
Building VlocMat, elapsed time: 1.93 seconds
Building SOmat, elapsed time: 0.31 seconds
Building NLmat, elapsed time: 0.59 seconds
Building Htot, elapsed time: 2.85 seconds
eigvalsh and storing energies, elapsed time: 11.26 seconds
loss_backward + optimizer.step, elapsed time: 5.88 seconds
Building VlocMat, elapsed time: 1.69 seconds
Building SOmat, elapsed time: 0.26 seconds
Building NLmat, elapsed time: 0.60 seconds
Building Htot, elapsed time: 2.58 seconds
eigvalsh and storing energies, elapsed time: 11.14 seconds
loss_backward + optimizer.step, elapsed time: 6.36 seconds
Building VlocMat, elapsed time: 1.92 seconds
Building SOmat, elapsed time: 0.34 seconds
Building NLmat, elapsed time: 0.61 seconds
Building Htot, elapsed time: 2.90 seconds
eigvalsh and storing energies, elapsed time: 11.29 seconds
loss_backward + optimizer.step, elapsed time: 6.28 seconds
Epoch [1/1], training cost: 209.6409
Building VlocMat, elapsed time: 1.30 seconds
Building SOmat, elapsed time: 0.22 seconds
Building NLmat, elapsed time: 0.41 seconds
Building Htot, elapsed time: 1.95 seconds
eigvalsh and storing energies, elapsed time: 4.70 seconds
Building VlocMat, elapsed time: 1.53 seconds
Building SOmat, elapsed time: 0.21 seconds
Building NLmat, elapsed time: 0.41 seconds
Building Htot, elapsed time: 2.18 seconds
eigvalsh and storing energies, elapsed time: 4.73 seconds
Building VlocMat, elapsed time: 1.69 seconds
Building SOmat, elapsed time: 0.23 seconds
Building NLmat, elapsed time: 0.40 seconds
Building Htot, elapsed time: 2.35 seconds
eigvalsh and storing energies, elapsed time: 4.66 seconds
Epoch [1/1], validation cost: 32.3732
Training elapsed time: 82.08 seconds

########################################
Writing the NN pseudopotentials
