############################################
# Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

Setting OMP_NUM_THREADS = 256, MKL_NUM_THREADS = 256
########################################
Reading and setting up the BulkSystems.
There are 3 atomic pseudopotentials. They are in the order of: ['Cs' 'I' 'Pb']

Initializing the ham class for each BulkSystem. 
initializing SO: kpt 1/3
initializing SO: kpt 2/3
initializing SO: kpt 3/3
initializing NL pots: kpt 1/3
time int1: 1.090256690979004
int2 est. maxerr: 2.0416060129877493e-05
time int2: 0.9846932888031006
initializing NL pots: kpt 2/3
time int1: 1.1330175399780273
int2 est. maxerr: 2.2291572682285044e-05
time int2: 0.9537756443023682
initializing NL pots: kpt 3/3
time int1: 1.1231532096862793
int2 est. maxerr: 2.0926245816032496e-05
time int2: 0.9075584411621094
Elapsed time: 16.20 seconds

Building VlocMat, elapsed time: 0.28 seconds
Building SOmat, elapsed time: 0.49 seconds
Building NLmat, elapsed time: 0.93 seconds
Building Htot, elapsed time: 1.79 seconds
eigvalsh and storing energies, elapsed time: 7.40 seconds
Building VlocMat, elapsed time: 0.18 seconds
Building SOmat, elapsed time: 0.50 seconds
Building NLmat, elapsed time: 0.93 seconds
Building Htot, elapsed time: 1.75 seconds
eigvalsh and storing energies, elapsed time: 6.57 seconds
Building VlocMat, elapsed time: 0.11 seconds
Building SOmat, elapsed time: 0.39 seconds
Building NLmat, elapsed time: 0.83 seconds
Building Htot, elapsed time: 1.51 seconds
eigvalsh and storing energies, elapsed time: 6.09 seconds
Old Zunger BS: Finished calculating 0-th band structure in the Zunger function form ... Elapsed time: 25.19 seconds
The total bandStruct MSE = 1.953641e-01 

########################################
Initializing the NN with file test_parallel/inputs_SOC_noPara/init_PPmodel.pth.
Done with NN initialization to the file test_parallel/inputs_SOC_noPara/init_PPmodel.pth.
Plotting and write pseudopotentials in the real and reciprocal space.

Evaluating band structures using the initialized pseudopotentials. 
Building VlocMat, elapsed time: 1.22 seconds
Building SOmat, elapsed time: 0.46 seconds
Building NLmat, elapsed time: 0.82 seconds
Building Htot, elapsed time: 2.83 seconds
eigvalsh and storing energies, elapsed time: 6.31 seconds
Building VlocMat, elapsed time: 1.23 seconds
Building SOmat, elapsed time: 0.40 seconds
Building NLmat, elapsed time: 0.68 seconds
Building Htot, elapsed time: 2.71 seconds
eigvalsh and storing energies, elapsed time: 5.98 seconds
Building VlocMat, elapsed time: 1.11 seconds
Building SOmat, elapsed time: 0.40 seconds
Building NLmat, elapsed time: 0.80 seconds
Building Htot, elapsed time: 2.69 seconds
eigvalsh and storing energies, elapsed time: 6.10 seconds
Finished calculating 0-th band structure in the initialized NN form... Elapsed time: 26.65 seconds
The total bandStruct MSE = 7.788923e+01 

########################################
Start training of the NN to fit to band structures. 
Building VlocMat, elapsed time: 1.43 seconds
Building SOmat, elapsed time: 0.41 seconds
Building NLmat, elapsed time: 0.86 seconds
Building Htot, elapsed time: 2.83 seconds
eigvalsh and storing energies, elapsed time: 7.03 seconds
loss_backward + optimizer.step, elapsed time: 8.06 seconds
Building VlocMat, elapsed time: 1.19 seconds
Building SOmat, elapsed time: 0.33 seconds
Building NLmat, elapsed time: 0.80 seconds
Building Htot, elapsed time: 2.38 seconds
eigvalsh and storing energies, elapsed time: 6.50 seconds
loss_backward + optimizer.step, elapsed time: 8.47 seconds
Building VlocMat, elapsed time: 1.18 seconds
Building SOmat, elapsed time: 0.39 seconds
Building NLmat, elapsed time: 0.72 seconds
Building Htot, elapsed time: 2.35 seconds
eigvalsh and storing energies, elapsed time: 6.08 seconds
loss_backward + optimizer.step, elapsed time: 8.42 seconds
Epoch [1/1], training cost: 209.6415
Building VlocMat, elapsed time: 1.62 seconds
Building SOmat, elapsed time: 0.42 seconds
Building NLmat, elapsed time: 0.89 seconds
Building Htot, elapsed time: 3.08 seconds
eigvalsh and storing energies, elapsed time: 6.77 seconds
Building VlocMat, elapsed time: 1.61 seconds
Building SOmat, elapsed time: 0.40 seconds
Building NLmat, elapsed time: 0.78 seconds
Building Htot, elapsed time: 2.98 seconds
eigvalsh and storing energies, elapsed time: 7.11 seconds
Building VlocMat, elapsed time: 1.50 seconds
Building SOmat, elapsed time: 0.40 seconds
Building NLmat, elapsed time: 0.80 seconds
Building Htot, elapsed time: 2.89 seconds
eigvalsh and storing energies, elapsed time: 6.62 seconds
Epoch [1/1], validation cost: 32.3732
Training elapsed time: 83.58 seconds

########################################
Writing the NN pseudopotentials
