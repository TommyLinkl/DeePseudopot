############################################
# Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

Setting OMP_NUM_THREADS = 1, MKL_NUM_THREADS = 1
########################################
Reading and setting up the BulkSystems.
There are 3 atomic pseudopotentials. They are in the order of: ['Cs' 'I' 'Pb']

Initializing the ham class for each BulkSystem. 
Elapsed time: 0.00 seconds

Total num_cores available = 256. We are using num_cores = 1.
Building VlocMat, elapsed time: 0.61 seconds
Building Htot, elapsed time: 0.71 seconds
eigvalsh and storing energies, elapsed time: 0.70 seconds
Building VlocMat, elapsed time: 0.30 seconds
Building Htot, elapsed time: 0.36 seconds
eigvalsh and storing energies, elapsed time: 0.47 seconds
Building VlocMat, elapsed time: 0.27 seconds
Building Htot, elapsed time: 0.30 seconds
eigvalsh and storing energies, elapsed time: 0.46 seconds
Old Zunger BS: Finished calculating 0-th band structure in the Zunger function form ... Elapsed time: 3.15 seconds
The total bandStruct MSE = 1.925923e+01 

########################################
Initializing the NN with file test_parallel/inputs_noSOC_para1/init_PPmodel.pth.
Done with NN initialization to the file test_parallel/inputs_noSOC_para1/init_PPmodel.pth.
Plotting and write pseudopotentials in the real and reciprocal space.

Evaluating band structures using the initialized pseudopotentials. 
Total num_cores available = 256. We are using num_cores = 1.
Building VlocMat, elapsed time: 5.05 seconds
Building Htot, elapsed time: 5.27 seconds
eigvalsh and storing energies, elapsed time: 0.64 seconds
Building VlocMat, elapsed time: 4.21 seconds
Building Htot, elapsed time: 4.41 seconds
eigvalsh and storing energies, elapsed time: 0.61 seconds
Building VlocMat, elapsed time: 4.26 seconds
Building Htot, elapsed time: 4.42 seconds
eigvalsh and storing energies, elapsed time: 0.65 seconds
Finished calculating 0-th band structure in the initialized NN form... Elapsed time: 16.15 seconds
The total bandStruct MSE = 9.239716e+01 

########################################
Start training of the NN to fit to band structures. 
Total num_cores available = 256. We are using num_cores = 1.
Building VlocMat, elapsed time: 3.46 seconds
Building Htot, elapsed time: 3.57 seconds
eigvalsh and storing energies, elapsed time: 1.18 seconds
loss_backward + optimizer.step, elapsed time: 3.74 seconds
Building VlocMat, elapsed time: 2.70 seconds
Building Htot, elapsed time: 2.74 seconds
eigvalsh and storing energies, elapsed time: 1.34 seconds
loss_backward + optimizer.step, elapsed time: 3.69 seconds
Building VlocMat, elapsed time: 2.46 seconds
Building Htot, elapsed time: 2.50 seconds
eigvalsh and storing energies, elapsed time: 1.26 seconds
loss_backward + optimizer.step, elapsed time: 3.80 seconds
Epoch [1/1], training cost: 219.2325
Total num_cores available = 256. We are using num_cores = 1.
Building VlocMat, elapsed time: 3.11 seconds
Building Htot, elapsed time: 3.18 seconds
eigvalsh and storing energies, elapsed time: 0.49 seconds
Building VlocMat, elapsed time: 2.92 seconds
Building Htot, elapsed time: 2.96 seconds
eigvalsh and storing energies, elapsed time: 0.46 seconds
Building VlocMat, elapsed time: 2.79 seconds
Building Htot, elapsed time: 2.83 seconds
eigvalsh and storing energies, elapsed time: 0.49 seconds
Epoch [1/1], validation cost: 55.8718
Training elapsed time: 37.37 seconds

########################################
Writing the NN pseudopotentials
