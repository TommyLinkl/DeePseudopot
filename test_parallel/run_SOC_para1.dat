############################################
# Using separateKptGrad. This can decrease the peak memory load during the fitting code. 
############################################

Setting OMP_NUM_THREADS = 1, MKL_NUM_THREADS = 1
########################################
Reading and setting up the BulkSystems.
There are 3 atomic pseudopotentials. They are in the order of: ['Cs' 'I' 'Pb']

Initializing the ham class for each BulkSystem. 
initializing SO: kpt 1/3
initializing SO: kpt 2/3
initializing SO: kpt 3/3
initializing NL pots: kpt 1/3
time int1: 1.323267936706543
int2 est. maxerr: 2.0416060129877493e-05
time int2: 1.278294324874878
initializing NL pots: kpt 2/3
time int1: 1.8040485382080078
int2 est. maxerr: 2.2291572682285044e-05
time int2: 0.883399248123169
initializing NL pots: kpt 3/3
time int1: 1.0738215446472168
int2 est. maxerr: 2.0926245816032496e-05
time int2: 0.9962239265441895
Finished putting the cached SO and NLmats into shared memory ...
Elapsed time: 26.25 seconds

Total num_cores available = 256. We are using num_cores = 1.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 0.65 seconds
Building SOmat, elapsed time: 1.03 seconds
Building NLmat, elapsed time: 1.57 seconds
Building Htot, elapsed time: 3.45 seconds
eigvalsh and storing energies, elapsed time: 3.14 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 0.34 seconds
Building SOmat, elapsed time: 0.57 seconds
Building NLmat, elapsed time: 1.44 seconds
Building Htot, elapsed time: 2.43 seconds
eigvalsh and storing energies, elapsed time: 3.21 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 0.35 seconds
Building SOmat, elapsed time: 0.52 seconds
Building NLmat, elapsed time: 1.61 seconds
Building Htot, elapsed time: 2.57 seconds
eigvalsh and storing energies, elapsed time: 3.03 seconds
Old Zunger BS: Finished calculating 0-th band structure in the Zunger function form ... Elapsed time: 18.13 seconds
The total bandStruct MSE = 1.953641e-01 

########################################
Initializing the NN with file test_parallel/inputs_SOC_para1/init_PPmodel.pth.
Done with NN initialization to the file test_parallel/inputs_SOC_para1/init_PPmodel.pth.
Plotting and write pseudopotentials in the real and reciprocal space.

Evaluating band structures using the initialized pseudopotentials. 
Total num_cores available = 256. We are using num_cores = 1.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 4.73 seconds
Building SOmat, elapsed time: 1.33 seconds
Building NLmat, elapsed time: 2.65 seconds
Building Htot, elapsed time: 9.10 seconds
eigvalsh and storing energies, elapsed time: 5.04 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.71 seconds
Building SOmat, elapsed time: 1.30 seconds
Building NLmat, elapsed time: 1.54 seconds
Building Htot, elapsed time: 6.74 seconds
eigvalsh and storing energies, elapsed time: 3.12 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 2.40 seconds
Building SOmat, elapsed time: 0.79 seconds
Building NLmat, elapsed time: 1.65 seconds
Building Htot, elapsed time: 5.02 seconds
eigvalsh and storing energies, elapsed time: 3.14 seconds
Finished calculating 0-th band structure in the initialized NN form... Elapsed time: 32.72 seconds
The total bandStruct MSE = 7.788928e+01 

########################################
Start training of the NN to fit to band structures. 
Total num_cores available = 256. We are using num_cores = 1.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 2.95 seconds
Building SOmat, elapsed time: 0.89 seconds
Building NLmat, elapsed time: 1.62 seconds
Building Htot, elapsed time: 5.66 seconds
eigvalsh and storing energies, elapsed time: 10.07 seconds
loss_backward + optimizer.step, elapsed time: 7.36 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 2.41 seconds
Building SOmat, elapsed time: 0.83 seconds
Building NLmat, elapsed time: 1.64 seconds
Building Htot, elapsed time: 4.96 seconds
eigvalsh and storing energies, elapsed time: 9.78 seconds
loss_backward + optimizer.step, elapsed time: 7.05 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 2.42 seconds
Building SOmat, elapsed time: 0.75 seconds
Building NLmat, elapsed time: 1.52 seconds
Building Htot, elapsed time: 4.77 seconds
eigvalsh and storing energies, elapsed time: 9.70 seconds
loss_backward + optimizer.step, elapsed time: 11.27 seconds
Epoch [1/1], training cost: 209.6416
Total num_cores available = 256. We are using num_cores = 1.
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 3.31 seconds
Building SOmat, elapsed time: 0.67 seconds
Building NLmat, elapsed time: 1.52 seconds
Building Htot, elapsed time: 5.71 seconds
eigvalsh and storing energies, elapsed time: 3.17 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 2.51 seconds
Building SOmat, elapsed time: 0.63 seconds
Building NLmat, elapsed time: 1.67 seconds
Building Htot, elapsed time: 4.89 seconds
eigvalsh and storing energies, elapsed time: 3.17 seconds
Loading shared memory, elapsed time: 0.00 seconds
Building VlocMat, elapsed time: 2.48 seconds
Building SOmat, elapsed time: 0.71 seconds
Building NLmat, elapsed time: 1.61 seconds
Building Htot, elapsed time: 4.88 seconds
eigvalsh and storing energies, elapsed time: 3.09 seconds
Epoch [1/1], validation cost: 32.3732
Training elapsed time: 98.93 seconds

########################################
Writing the NN pseudopotentials
